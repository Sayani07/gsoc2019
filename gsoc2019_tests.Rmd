---
title: "Test solutions for R project : gravitas"
author: "Sayani Gupta"
date: "3/22/2019"
output: html_document
---


```{r setup, include=FALSE, echo=TRUE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, cache=TRUE)
# Load any R packages you need here
library(ggplot2)
library(dplyr)
library(lubridate)
library(ggplot2)
library(lvplot)
library(ggridges)
library(tsibbledata)
library(purrr)
```


_*Easy*_:

Explore the data aus_elec (Half-hourly electricity demand for five Australian states) from the package tsibbledata and create five different probability distribution plots for each month. For example, boxplot which shows median, quartile boundaries, hinges, whiskers and outliers is one of the ways to display distribution of data. 


```{r easy, echo=TRUE}

# distinct states

aus_elec %>%  distinct(State)

# time range

aus_elec %>%
          .$Time %>% range()

# Picking atate Queensland and years 2012, 2013 and 2014

qld_elec <- aus_elec %>%
            filter(State =="Queensland") %>%
            filter(year(Time) %in% 2012:2014) %>%  
            mutate(data_month = lubridate::month(Time))

# Boxplot

qld_elec %>% ggplot(aes(as.factor(data_month),Demand))+
geom_boxplot() + 
ylab("Demand in MW") +
xlab("Months") +
scale_x_discrete(breaks=seq(1,12,1)) +
theme(legend.position = "bottom",strip.text = element_text(size = 7, margin = margin())) + ggtitle("Boxplot of demand for QLD")

# Ridge Plot

qld_elec %>% 
  ggplot(aes(x = Demand,y=as.factor(data_month),group=data_month)) +   geom_density_ridges2() +
  xlab("Demand in MW") +
  ylab("Months")+ 
  theme(legend.position = "bottom",strip.text = element_text(size = 7, margin = margin())) + ggtitle("Ridge plot of demand for QLD")

# Violin Plot 

qld_elec %>% ggplot(aes(as.factor(data_month), Demand)) + geom_violin(alpha = 0.03) + ylab("Demand in MW") +
xlab("Months")  +
theme(legend.position = "bottom", strip.text = element_text(size = 7, margin = margin())) +
ggtitle("Violin plot of demand for QLD")

# Decile Plot

qld_decile <- qld_elec %>% 
  dplyr::group_by(data_month) %>%
  do({x <- .$Demand
  map_dfr(.x = seq(0.1,0.9,0.1),
          .f = ~ tibble(Quantile = .x,
                            Value = quantile(x, probs = .x,na.rm=TRUE)))
  })
  

p1 <- qld_decile %>% 
  ggplot(aes(x=data_month,y=Value,col=as.factor(Quantile))) +    geom_line() + ggtitle("Decile plot of demand for QLD") + ylab("Demand in MW") +
  xlab("Months")

p1

```

